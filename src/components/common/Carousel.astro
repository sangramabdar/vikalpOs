<div class="relative w-full overflow-hidden p-4 px-8 slideInUp">
  <div
    id="carousel-track"
    class="transition-transform duration-500 ease-in-out flex"
  >
    <slot />
  </div>

  <!-- Navigation -->
  <button
    id="carousel-prev"
    class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white p-2 shadow rounded-full"
  >
    ‹
  </button>
  <button
    id="carousel-next"
    class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white p-2 shadow rounded-full"
  >
    ›
  </button>
</div>

<script>
  const track = document.getElementById("carousel-track") as HTMLElement;
  const prevBtn = document.getElementById("carousel-prev") as HTMLButtonElement;
  const nextBtn = document.getElementById("carousel-next") as HTMLButtonElement;

  const isMobile = window.innerWidth < 1024;

  let index = 0;
  const slides = track.children;
  const total = slides.length;

  const updateButtons = () => {
    prevBtn.disabled = index === 0;
    nextBtn.disabled = index >= total - 1;
  };

  const moveSlide = (direction: number, widthIndex: number = 1) => {
    const offsetWidth = slides[0].offsetWidth;
    const carouselTrackWidth = track.offsetWidth;
    const scrollWidth = slides.length * offsetWidth;

    if (carouselTrackWidth >= scrollWidth || scrollWidth <= offsetWidth) return;

    if (index < total)
      track.style.transform = `translateX(-${index * offsetWidth}px)`;

    index += direction;

    updateButtons();
  };

  let direction = "forward";

  setInterval(() => {
    if (index >= total) {
      direction = "backward";
    }

    if (index <= 0) {
      direction = "forward";
    }

    if (direction === "forward") {
      if (isMobile) moveSlide(1);
      else moveSlide(3);
    } else {
      if (isMobile) moveSlide(-1);
      else moveSlide(-3);
    }
  }, 2000);

  prevBtn.addEventListener("click", () => moveSlide(-1));
  nextBtn.addEventListener("click", () => moveSlide(1));
</script>
